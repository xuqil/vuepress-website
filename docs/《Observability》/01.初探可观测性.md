---
title: 初探可观测性
date: 2023-05-07 19:41:14
permalink: /pages/a66ff3/
categories: 
  - 《Observability》
tags: 
  - null
author: 
  name: xuqil
  link: https://github.com/xuqil
---

# 初探可观测性

## 什么是可观测性

在互联网应用中，**可观测性（observability）**指的是通过监控、记录和分析系统的数据来了解系统的状态和行为。这些数据可以包括系统的**指标、日志、跟踪、事件**等等。通过对这些数据的分析，我们可以发现系统的性能瓶颈、故障原因、异常行为等等，从而帮助我们及时发现和解决问题，提高系统的可靠性和性能。

互联网应用通常由多个分布式服务组成，这些服务可能由不同的团队开发和维护，它们之间相互依赖，共同构成了一个大型的系统。在这样的系统中，问题往往不是单一服务的问题，而是多个服务之间的协作问题。因此，可观测性在互联网应用中显得尤为重要。

常用的可观测性工具包括监控工具、日志工具、跟踪工具、告警工具等等。通过这些工具，我们可以对系统进行全方位的监控和分析，了解系统的状态和行为。例如，我们可以监控系统的各种指标，例如 CPU、内存、网络流量等等，从而了解系统的运行状态；我们还可以收集、分析和可视化系统的日志信息，从而帮助我们发现系统的错误、异常行为等等；我们还可以跟踪系统的请求流程、服务调用等等，从而帮助我们分析系统的性能瓶颈和故障原因。

在云计算中，可观测性还指聚集、关联和分析分布式应用程序及其运行所用硬件的稳定性能数据流的软件工具和实践，以更高效地监控、故障排除和调试该应用程序，达到满足客户体验预期、服务级别协议 (SLA) 和其他业务要求的目的。

## 为什么我们需要可观测性

可观察性让我们从外部了解系统，让我们在不知道其内部运作的情况下提出有关该系统的问题。此外，它使我们能够轻松解决和处理新问题（即“未知的未知数”），并帮助我们回答“为什么会发生这种情况？”的问题。

可观测性在**系统分析、控制、诊断和故障排除**等方面都非常重要，以下是一些具体原因：

1. **了解系统状态、及时发现问题和解决问题**：由于互联网应用通常由多个分布式服务组成，这些服务之间相互依赖，共同构成了一个大型的系统。因此，当系统出现问题时，问题往往不是单一服务的问题，而是多个服务之间的协作问题。通过可观测性工具，我们可以对整个系统进行监控和分析，及时发现和定位问题，帮助我们快速解决问题。
2. **保证系统安全**：通过监控和分析系统的日志信息，我们可以发现系统的异常行为，包括恶意攻击和安全漏洞等等，及时采取措施保护系统的安全性。
3. **性能优化**：通过监控系统的指标，例如CPU、内存、网络流量等等，我们可以了解系统的运行状态，发现性能瓶颈，进而对系统进行优化，提高系统的性能和响应速度。
4. **改进系统设计**：通过跟踪系统的请求流程、服务调用等等，我们可以了解系统的架构和设计，发现问题并改进系统的设计，从而提高系统的可靠性和可维护性。

因此，可观测性是一种非常重要的系统特性，对于系统的设计、分析和优化都有着重要的意义。

## 可观测性如何工作

可观测性（observability）是指在分布式系统中，对系统运行状态、性能指标、异常情况等各方面进行全面、准确、及时的监控和诊断的能力。可观测性是现代化软件开发中的重要概念之一，它可以帮助开发团队快速识别和解决系统中的问题，提高系统的稳定性和可靠性。

通常来说，可观测性包括以下几个方面：

1. **监控（Monitoring）**：监控是指对系统运行状态、性能指标等进行实时、全面、可视化的监测，以便及时发现和解决问题。监控可以通过日志、指标、跟踪等方式实现。
2. **日志（Logging）**：日志是指系统运行时产生的事件和信息，包括调试信息、错误信息、警告信息等。日志可以用来了解系统的运行状态，快速发现问题并解决问题。
3. **指标（Metrics）**：指标是指系统运行时产生的各种性能指标，例如 CPU 占用率、内存使用率、网络带宽等。指标可以用来衡量系统的性能和稳定性，并进行故障排查和问题诊断。
4. **分布式追踪（Distributed tracing）**：分布式追踪是指在分布式系统中追踪请求和响应的路径和流程，以便于定位和解决问题。分布式追踪可以帮助开发者快速识别问题的根源，从而更好地维护系统的稳定性和可靠性。

其中最主要的是：日志（Logging）、指标（Metrics）和跟踪（Tracing）。

为了实现可观测性，开发团队可以采用一些工具和技术，例如 Prometheus、Grafana、ELK 等。同时，也需要在系统设计和开发过程中考虑可观测性，例如添加适当的日志记录、指标监测和分布式追踪等功能，以便于快速诊断和解决问题。

## 常用工具

在实际应用中，常用的可观测性工具包括：

1. 监控工具：例如Prometheus、Grafana、Zabbix等工具可以监控系统的各种指标，例如CPU、内存、网络流量等等，从而了解系统的运行状态。
2. 告警工具：例如Prometheus Alertmanager、Nagios等工具可以设置告警规则，当系统出现故障或者异常行为时，及时通知运维人员进行处理。
3. 日志工具：例如ELK、Splunk等工具可以收集、分析和可视化系统的日志信息，从而帮助我们发现系统的错误、异常行为等等。
4. 分布式追踪工具：分布式追踪工具可以帮助我们跟踪整个请求流程，了解请求在各个服务之间的调用情况，帮助我们发现问题并优化系统的性能。常用的分布式追踪工具包括Zipkin、Jaeger、OpenTelemetry等。
5. 应用性能监控（APM）工具：APM 工具可以监控应用程序的性能，包括请求延迟、内存使用情况、CPU使用情况等等，帮助我们定位性能瓶颈。常用的 APM 工具包括 New Relic、Datadog、AppDynamics 等。

## 可靠性和指标

互联网应用的可靠性指的是该应用能够在一定条件下保持稳定的运行状态并能够正常地完成其预定的功能。现代互联网应用的可靠性需要考虑多方面的因素，如系统硬件和软件的稳定性、网络连接的稳定性、数据安全性等等。

以下是一些常用的互联网应用可靠性指标：

- 可用性：可用性是指系统在特定时间段内能够正常运行的时间比例。可用性通常以百分比的形式表示，例如99.9%的可用性意味着系统每年最多只能停机9个小时。
- 故障率：故障率是指系统在特定时间段内发生故障的次数。通常以每小时或每天的故障次数表示。
- 平均故障间隔时间（MTBF）：MTBF是指系统在运行一段时间后平均发生故障的时间。MTBF越长，系统的稳定性就越高。
- 平均修复时间（MTTR）：MTTR是指系统故障后平均修复的时间。MTTR越短，系统的可靠性就越高。
- 可恢复性：可恢复性是指系统发生故障后能够快速恢复正常运行的能力。通常包括备份、灾备等措施。
- 数据完整性：数据完整性是指系统能够保证数据的正确性、完整性和安全性。数据完整性通常包括备份、数据加密、访问控制等方面的措施。
- 性能：性能是指系统在特定条件下处理事务的能力。通常包括响应时间、吞吐量等指标。高性能的系统可以更快地完成任务，提高用户体验。

## 参考

- [What is Observability? An Overview](https://www.motadata.com/blog/what-is-observability/)
- [Observability Primer](https://opentelemetry.io/docs/concepts/observability-primer/)
- [可观测性](https://www.ibm.com/cn-zh/topics/observability)
- [shardingsphere 可观察性](https://shardingsphere.apache.org/document/current/cn/features/observability/)